<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>working-document</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Working Document_files/libs/clipboard/clipboard.min.js"></script>
<script src="Working Document_files/libs/quarto-html/quarto.js"></script>
<script src="Working Document_files/libs/quarto-html/popper.min.js"></script>
<script src="Working Document_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Working Document_files/libs/quarto-html/anchor.min.js"></script>
<link href="Working Document_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Working Document_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Working Document_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Working Document_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Working Document_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<div class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.outliers_influence <span class="im">import</span> variance_inflation_factor</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tools.tools <span class="im">import</span> add_constant</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge, RidgeCV, Lasso, LassoCV</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="reading-in-the-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-in-the-data">Reading in the Data</h2>
<div class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dashboard_2015 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2015 Dashboard.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2015 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2015 Batted Ball.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>statcast_2015 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2015 Statcast.csv'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>dashboard_2016 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2016 Dashboard.csv'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>batted_ball_2016 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2016 Batted Ball.csv'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>statcast_2016 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2016 Statcast.csv'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>dashboard_2017 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2017 Dashboard.csv'</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>batted_ball_2017 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2017 Batted Ball.csv'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>statcast_2017 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2017 Statcast.csv'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>dashboard_2018 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2018 Dashboard.csv'</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>batted_ball_2018 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2018 Batted Ball.csv'</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>statcast_2018 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2018 Statcast.csv'</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>dashboard_2019 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2019 Dashboard.csv'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>batted_ball_2019 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2019 Batted Ball.csv'</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>statcast_2019 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2019 Statcast.csv'</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>dashboard_2020 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2020 Dashboard.csv'</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>batted_ball_2020 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2020 Batted Ball.csv'</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>statcast_2020 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2020 Statcast.csv'</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>dashboard_2021 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2021 Dashboard.csv'</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>batted_ball_2021 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2021 Batted Ball.csv'</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>statcast_2021 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2021 Statcast.csv'</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>dashboard_2022 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2022 Dashboard.csv'</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>batted_ball_2022 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2022 Batted Ball.csv'</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>statcast_2022 <span class="op">=</span> pd.read_csv(<span class="vs">r'.\Datasets\2022 Statcast.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dealing-with-2020" class="level3">
<h3 class="anchored" data-anchor-id="dealing-with-2020">Dealing with 2020</h3>
<p>Due to the pandemic, there were only 60 regular season games in the 2020 MLB season, as opposed to 162 in a normal year. To work around this, I lowered the plate appearance threshold in 2020 to 70, which resulted in a similar-sized player pool (approximately 350) to the rest of the years, and for any “counting stats,” like Home Runs or Plate Apppearances or whatever, I will scale them up by an appropriate factor to make it seem like it was over a 162 game season. This does however not address the variance in home runs vs.&nbsp;predictive factors in a smaller sample of games (i.e.&nbsp;hitting 15 home runs in 60 games when the data suggests the expected HR total was 10 now becomes hitting 40 home runs with an expected total of like 25), but we’re just going to have to live with it and hopefully that variance evens out across the player pool.</p>
</section>
</section>
<section id="cleaning-the-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-data">Cleaning the Data</h2>
<ul>
<li>Combine yearly frames by player</li>
<li>Add a year column</li>
<li>Add following season HR total to the frames</li>
<li>Filter out players with a missing value in the HR total</li>
<li>Subset variables that could be useful</li>
<li>Divide yearly frames into 80% train and 20% test using random functions with a set seed</li>
<li>Combine the yearly train frames into an overall train set and same for test</li>
<li>Format percentages</li>
</ul>
<div class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dashboard_2015_merge <span class="op">=</span> dashboard_2015.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2015_merge <span class="op">=</span> batted_ball_2015.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>statcast_2015_merge <span class="op">=</span> statcast_2015.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>temp_frame_2015 <span class="op">=</span> pd.merge(dashboard_2015_merge, batted_ball_2015_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>temp_frame_2015_2 <span class="op">=</span> pd.merge(temp_frame_2015, statcast_2015_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2015_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2015</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>next_season_hr_2015 <span class="op">=</span> dashboard_2016.loc[:, [<span class="st">'HR'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>next_season_hr_2015 <span class="op">=</span> next_season_hr_2015.rename(columns <span class="op">=</span> {<span class="st">'HR'</span>:<span class="st">'Next_Year_HR'</span>})</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>frame_2015 <span class="op">=</span> pd.merge(temp_frame_2015_2, next_season_hr_2015, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>frame_2015.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="183">
<pre><code>(271, 22)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">271</span> <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="184">
<pre><code>216.8</code></pre>
</div>
</div>
<div class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>train_2015 <span class="op">=</span> frame_2015.sample(n <span class="op">=</span> <span class="dv">217</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>temp_df <span class="op">=</span> frame_2015.merge(train_2015.drop_duplicates(), on <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>, <span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'Year'</span>, <span class="st">'Next_Year_HR'</span>], how <span class="op">=</span> <span class="st">'left'</span>, indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>test_2015 <span class="op">=</span> temp_df.loc[temp_df[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>, :]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>test_2015 <span class="op">=</span> test_2015.drop(<span class="st">'_merge'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dashboard_2016_merge <span class="op">=</span> dashboard_2016.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2016_merge <span class="op">=</span> batted_ball_2016.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>statcast_2016_merge <span class="op">=</span> statcast_2016.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>temp_frame_2016 <span class="op">=</span> pd.merge(dashboard_2016_merge, batted_ball_2016_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>temp_frame_2016_2 <span class="op">=</span> pd.merge(temp_frame_2016, statcast_2016_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2016_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2016</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>next_season_hr_2016 <span class="op">=</span> dashboard_2017.loc[:, [<span class="st">'HR'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>next_season_hr_2016 <span class="op">=</span> next_season_hr_2016.rename(columns <span class="op">=</span> {<span class="st">'HR'</span>:<span class="st">'Next_Year_HR'</span>})</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>frame_2016 <span class="op">=</span> pd.merge(temp_frame_2016_2, next_season_hr_2016, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>frame_2016.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="186">
<pre><code>(261, 22)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dv">261</span> <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>208.8</code></pre>
</div>
</div>
<div class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>train_2016 <span class="op">=</span> frame_2016.sample(n <span class="op">=</span> <span class="dv">219</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>temp_df <span class="op">=</span> frame_2016.merge(train_2016.drop_duplicates(), on <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>, <span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'Year'</span>, <span class="st">'Next_Year_HR'</span>], how <span class="op">=</span> <span class="st">'left'</span>, indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>test_2016 <span class="op">=</span> temp_df.loc[temp_df[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>, :]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>test_2016 <span class="op">=</span> test_2016.drop(<span class="st">'_merge'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dashboard_2017_merge <span class="op">=</span> dashboard_2017.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2017_merge <span class="op">=</span> batted_ball_2017.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>statcast_2017_merge <span class="op">=</span> statcast_2017.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>temp_frame_2017 <span class="op">=</span> pd.merge(dashboard_2017_merge, batted_ball_2017_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>temp_frame_2017_2 <span class="op">=</span> pd.merge(temp_frame_2017, statcast_2017_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2017_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2017</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>next_season_hr_2017 <span class="op">=</span> dashboard_2018.loc[:, [<span class="st">'HR'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>next_season_hr_2017 <span class="op">=</span> next_season_hr_2017.rename(columns <span class="op">=</span> {<span class="st">'HR'</span>:<span class="st">'Next_Year_HR'</span>})</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>frame_2017 <span class="op">=</span> pd.merge(temp_frame_2017_2, next_season_hr_2017, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>frame_2017.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>(277, 22)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">277</span> <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="190">
<pre><code>221.60000000000002</code></pre>
</div>
</div>
<div class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>train_2017 <span class="op">=</span> frame_2017.sample(n <span class="op">=</span> <span class="dv">222</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>temp_df <span class="op">=</span> frame_2017.merge(train_2017.drop_duplicates(), on <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>, <span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'Year'</span>, <span class="st">'Next_Year_HR'</span>], how <span class="op">=</span> <span class="st">'left'</span>, indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>test_2017 <span class="op">=</span> temp_df.loc[temp_df[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>, :]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>test_2017 <span class="op">=</span> test_2017.drop(<span class="st">'_merge'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dashboard_2018_merge <span class="op">=</span> dashboard_2018.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2018_merge <span class="op">=</span> batted_ball_2018.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>statcast_2018_merge <span class="op">=</span> statcast_2018.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>temp_frame_2018 <span class="op">=</span> pd.merge(dashboard_2018_merge, batted_ball_2018_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>temp_frame_2018_2 <span class="op">=</span> pd.merge(temp_frame_2018, statcast_2018_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2018_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2018</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>next_season_hr_2018 <span class="op">=</span> dashboard_2019.loc[:, [<span class="st">'HR'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>next_season_hr_2018 <span class="op">=</span> next_season_hr_2018.rename(columns <span class="op">=</span> {<span class="st">'HR'</span>:<span class="st">'Next_Year_HR'</span>})</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>frame_2018 <span class="op">=</span> pd.merge(temp_frame_2018_2, next_season_hr_2018, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>frame_2018.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="192">
<pre><code>(262, 22)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dv">262</span> <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">
<pre><code>209.60000000000002</code></pre>
</div>
</div>
<div class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>train_2018 <span class="op">=</span> frame_2018.sample(n <span class="op">=</span> <span class="dv">210</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>temp_df <span class="op">=</span> frame_2018.merge(train_2018.drop_duplicates(), on <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>, <span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'Year'</span>, <span class="st">'Next_Year_HR'</span>], how <span class="op">=</span> <span class="st">'left'</span>, indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>test_2018 <span class="op">=</span> temp_df.loc[temp_df[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>, :]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>test_2018 <span class="op">=</span> test_2018.drop(<span class="st">'_merge'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dashboard_2019_merge <span class="op">=</span> dashboard_2019.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2019_merge <span class="op">=</span> batted_ball_2019.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>statcast_2019_merge <span class="op">=</span> statcast_2019.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>temp_frame_2019 <span class="op">=</span> pd.merge(dashboard_2019_merge, batted_ball_2019_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>temp_frame_2019_2 <span class="op">=</span> pd.merge(temp_frame_2019, statcast_2019_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2019_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2019</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>next_season_hr_2019 <span class="op">=</span> dashboard_2020.loc[:, [<span class="st">'HR'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>next_season_hr_2019[<span class="st">'HR'</span>] <span class="op">=</span> next_season_hr_2019[<span class="st">'HR'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>((<span class="dv">162</span><span class="op">/</span><span class="dv">60</span>)<span class="op">*</span>x))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>next_season_hr_2019 <span class="op">=</span> next_season_hr_2019.rename(columns <span class="op">=</span> {<span class="st">'HR'</span>:<span class="st">'Next_Year_HR'</span>})</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>frame_2019 <span class="op">=</span> pd.merge(temp_frame_2019_2, next_season_hr_2019, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>frame_2019.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="195">
<pre><code>(282, 22)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dv">282</span> <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="196">
<pre><code>225.60000000000002</code></pre>
</div>
</div>
<div class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>train_2019 <span class="op">=</span> frame_2019.sample(n <span class="op">=</span> <span class="dv">226</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>temp_df <span class="op">=</span> frame_2019.merge(train_2019.drop_duplicates(), on <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>, <span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'Year'</span>, <span class="st">'Next_Year_HR'</span>], how <span class="op">=</span> <span class="st">'left'</span>, indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>test_2019 <span class="op">=</span> temp_df.loc[temp_df[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>, :]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>test_2019 <span class="op">=</span> test_2019.drop(<span class="st">'_merge'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dashboard_2020_merge <span class="op">=</span> dashboard_2020.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>dashboard_2020_merge[<span class="st">'G'</span>] <span class="op">=</span> dashboard_2020_merge[<span class="st">'G'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>((<span class="dv">162</span><span class="op">/</span><span class="dv">60</span>) <span class="op">*</span> x))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>dashboard_2020_merge[<span class="st">'PA'</span>] <span class="op">=</span> dashboard_2020_merge[<span class="st">'PA'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>((<span class="dv">162</span><span class="op">/</span><span class="dv">60</span>) <span class="op">*</span> x))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>dashboard_2020_merge[<span class="st">'HR'</span>] <span class="op">=</span> dashboard_2020_merge[<span class="st">'HR'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>((<span class="dv">162</span><span class="op">/</span><span class="dv">60</span>) <span class="op">*</span> x))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>batted_ball_2020_merge <span class="op">=</span> batted_ball_2020.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>statcast_2020_merge <span class="op">=</span> statcast_2020.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2020 <span class="op">=</span> pd.merge(dashboard_2020_merge, batted_ball_2020_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>temp_frame_2020_2 <span class="op">=</span> pd.merge(temp_frame_2020, statcast_2020_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>temp_frame_2020_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2020</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>next_season_hr_2020 <span class="op">=</span> dashboard_2021.loc[:, [<span class="st">'HR'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>next_season_hr_2020 <span class="op">=</span> next_season_hr_2020.rename(columns <span class="op">=</span> {<span class="st">'HR'</span>:<span class="st">'Next_Year_HR'</span>})</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>frame_2020 <span class="op">=</span> pd.merge(temp_frame_2020_2, next_season_hr_2020, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>frame_2020.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="198">
<pre><code>(271, 22)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="dv">271</span> <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>216.8</code></pre>
</div>
</div>
<div class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>train_2020 <span class="op">=</span> frame_2020.sample(n <span class="op">=</span> <span class="dv">217</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>temp_df <span class="op">=</span> frame_2020.merge(train_2020.drop_duplicates(), on <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>, <span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'Year'</span>, <span class="st">'Next_Year_HR'</span>], how <span class="op">=</span> <span class="st">'left'</span>, indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>test_2020 <span class="op">=</span> temp_df.loc[temp_df[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>, :]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>test_2020 <span class="op">=</span> test_2020.drop(<span class="st">'_merge'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dashboard_2021_merge <span class="op">=</span> dashboard_2021.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2021_merge <span class="op">=</span> batted_ball_2021.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>statcast_2021_merge <span class="op">=</span> statcast_2021.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>temp_frame_2021 <span class="op">=</span> pd.merge(dashboard_2021_merge, batted_ball_2021_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>temp_frame_2021_2 <span class="op">=</span> pd.merge(temp_frame_2021, statcast_2021_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2021_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2021</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>next_season_hr_2021 <span class="op">=</span> dashboard_2022.loc[:, [<span class="st">'HR'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>next_season_hr_2021 <span class="op">=</span> next_season_hr_2021.rename(columns <span class="op">=</span> {<span class="st">'HR'</span>:<span class="st">'Next_Year_HR'</span>})</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>frame_2021 <span class="op">=</span> pd.merge(temp_frame_2021_2, next_season_hr_2021, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>frame_2021.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="201">
<pre><code>(267, 22)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="dv">267</span> <span class="op">*</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="202">
<pre><code>213.60000000000002</code></pre>
</div>
</div>
<div class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>train_2021 <span class="op">=</span> frame_2021.sample(n <span class="op">=</span> <span class="dv">214</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>temp_df <span class="op">=</span> frame_2021.merge(train_2021.drop_duplicates(), on <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>, <span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'Year'</span>, <span class="st">'Next_Year_HR'</span>], how <span class="op">=</span> <span class="st">'left'</span>, indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>test_2021 <span class="op">=</span> temp_df.loc[temp_df[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>, :]</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>test_2021 <span class="op">=</span> test_2021.drop(<span class="st">'_merge'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.concat([train_2015, train_2016, train_2017, train_2018, train_2019, train_2020, train_2021])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.rename(columns <span class="op">=</span> {<span class="st">'Barrel%'</span>: <span class="st">'Barrel'</span>, <span class="st">'HardHit%'</span>: <span class="st">'HardHit'</span>, <span class="st">'HR/FB'</span>: <span class="st">'HRperFB'</span>, <span class="st">'BB%'</span>:<span class="st">'BB'</span>, <span class="st">'K%'</span>:<span class="st">'K'</span>, <span class="st">'FB%'</span>:<span class="st">'FB'</span>, <span class="st">'Pull%'</span>:<span class="st">'Pull'</span>, <span class="st">'GB%'</span>:<span class="st">'GB'</span>, <span class="st">'LD%'</span>:<span class="st">'LD'</span>,<span class="st">'IFFB%'</span>:<span class="st">'IFFB'</span>, <span class="st">'Cent%'</span>:<span class="st">'Cent'</span>, <span class="st">'Oppo%'</span>:<span class="st">'Oppo'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.concat([test_2015, test_2016, test_2017, test_2018, test_2019, test_2020, test_2021])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="207">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> test.rename(columns <span class="op">=</span> {<span class="st">'Barrel%'</span>: <span class="st">'Barrel'</span>, <span class="st">'HardHit%'</span>: <span class="st">'HardHit'</span>, <span class="st">'HR/FB'</span>: <span class="st">'HRperFB'</span>, <span class="st">'BB%'</span>:<span class="st">'BB'</span>, <span class="st">'K%'</span>:<span class="st">'K'</span>, <span class="st">'FB%'</span>:<span class="st">'FB'</span>, <span class="st">'Pull%'</span>:<span class="st">'Pull'</span>, <span class="st">'GB%'</span>:<span class="st">'GB'</span>, <span class="st">'LD%'</span>:<span class="st">'LD'</span>,<span class="st">'IFFB%'</span>:<span class="st">'IFFB'</span>, <span class="st">'Cent%'</span>:<span class="st">'Cent'</span>, <span class="st">'Oppo%'</span>:<span class="st">'Oppo'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_percentage_sign(variable):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> variable.dtypes <span class="op">==</span> <span class="st">'O'</span>:</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>        variable <span class="op">=</span> variable.<span class="bu">str</span>.replace(<span class="st">'%'</span>, <span class="st">''</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>        variable <span class="op">=</span> pd.to_numeric(variable, errors <span class="op">=</span> <span class="st">'coerce'</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> variable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>train.loc[:, <span class="st">'G'</span>:] <span class="op">=</span> train.loc[:, <span class="st">'G'</span>:].<span class="bu">apply</span>(remove_percentage_sign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>test.loc[:, <span class="st">'G'</span>:] <span class="op">=</span> test.loc[:, <span class="st">'G'</span>:].<span class="bu">apply</span>(remove_percentage_sign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="211">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.reset_index().drop(<span class="st">'index'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="notes-on-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="notes-on-cleaning">Notes on Cleaning</h2>
<p><code>train</code> and <code>test</code> datasets have been created using 80% and 20% of the observations from 2015-2021 respectively, just run all of the code above and it should work.</p>
</section>
<section id="variable-descriptions" class="level2">
<h2 class="anchored" data-anchor-id="variable-descriptions">Variable Descriptions</h2>
<p>Excluding <code>'Name'</code> and <code>'playerid'</code>, there are 20 variables in the dataset to work with. Below are descriptions of them all.</p>
<p>All percentages are on a scale of 0 to 100, not 0 to 1.</p>
<ul>
<li><code>'Next_Year_HR'</code> (Response): Pretty explanatory, it’s the number of home runs a player hit in the following season, which is what we’re trying to predict. So, if an observation is Mike Trout in 2016, the value in this column is the number of home runs he hit in the 2017 season.</li>
<li><code>'G'</code>: The number of games played (out of 162) that season.</li>
<li><code>'PA'</code>: The number of plate appearances recorded that season.</li>
<li><code>'HR'</code>: The number of home runs hit that season.</li>
<li><code>'BB'</code>: The percentage of plate apperances that resulted in a walk.</li>
<li><code>'K'</code>: The percentage of plate appearances that resulted in a strikeout.</li>
<li><code>'LD'</code>/<code>'GB'</code>/<code>'FB'</code>: The percentage of batted ball events that are line drives/ground balls/fly balls.</li>
<li><code>'IFFB'</code>: The percentage of fly balls that are infield fly balls.</li>
<li><code>'HRperFB</code>’: The percentage of fly balls that are home runs.</li>
<li><code>'Pull'</code>/<code>'Cent'</code>/<code>'Oppo'</code>: The percentage of batted ball events that are hit in the three directions. For a right-handed hitter, pulling the ball means hitting it to left field and going to opposite field means hitting it to right field, and vice versa for left-handed batters. Generally, players will hit more home runs pulling the ball than going to center field, and even more than going to opposite field.</li>
<li><code>'EV'</code>: Average exit velocity in mph of the ball off the bat of all batted balls.</li>
<li><code>'maxEV'</code>: Fastest recorded exit velocity in mph of all batted balls.</li>
<li><code>'LA'</code>: Average angle of the trajectory of the ball off the bat of all batted balls. On a scale of -90 to 90 for each individual event, positive meaning it’s going in the air, and negative meaning it’s going into the ground.</li>
<li><code>'Barrel'</code>: Percentage of batted balls with exit velocity/launch angle profiles that have historically resulted in a hit at least 50% of the time.</li>
<li><code>'HardHit'</code>: The exact formula for determining what a qualifies as a hard hit ball is proprietary, but the name is pretty self explanatory.</li>
</ul>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="correlations" class="level2">
<h2 class="anchored" data-anchor-id="correlations">Correlations</h2>
<div class="cell" data-scrolled="true" data-execution_count="212">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>train.corrwith(train[<span class="st">'Next_Year_HR'</span>]).sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="212">
<pre><code>Next_Year_HR    1.000000
HR              0.580841
Barrel          0.510056
EV              0.484289
HardHit         0.475586
maxEV           0.469366
HRperFB         0.456887
FB              0.355472
PA              0.331875
LA              0.286869
Pull            0.284040
G               0.248870
BB              0.186282
K               0.162704
IFFB            0.055192
playerid        0.036181
Year           -0.047982
LD             -0.130726
Cent           -0.167033
Oppo           -0.246531
GB             -0.292824
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="plotting-relationships-between-response-and-predictors" class="level2">
<h2 class="anchored" data-anchor-id="plotting-relationships-between-response-and-predictors">Plotting Relationships Between Response and Predictors</h2>
<section id="hr" class="level3">
<h3 class="anchored" data-anchor-id="hr"><code>HR</code></h3>
<div class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">"figure.figsize"</span>] <span class="op">=</span> (<span class="dv">9</span>,<span class="dv">6</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x <span class="op">=</span> train[<span class="st">'HR'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>})</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Current Season HR'</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Next Season HR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="213">
<pre><code>Text(0, 0.5, 'Next Season HR')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="barrel" class="level3">
<h3 class="anchored" data-anchor-id="barrel"><code>Barrel</code></h3>
<div class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x <span class="op">=</span> train[<span class="st">'Barrel'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>})</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Barrel%'</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Next Season HR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="214">
<pre><code>Text(0, 0.5, 'Next Season HR')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-35-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="ev" class="level3">
<h3 class="anchored" data-anchor-id="ev"><code>EV</code></h3>
<div class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x <span class="op">=</span> train[<span class="st">'EV'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>})</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'EV'</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Next Season HR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="215">
<pre><code>Text(0, 0.5, 'Next Season HR')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-36-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="hardhit" class="level3">
<h3 class="anchored" data-anchor-id="hardhit"><code>HardHit</code></h3>
<div class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x <span class="op">=</span> train[<span class="st">'HardHit'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>})</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'HardHit%'</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Next Season HR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="216">
<pre><code>Text(0, 0.5, 'Next Season HR')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-37-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="maxev" class="level3">
<h3 class="anchored" data-anchor-id="maxev"><code>MaxEV</code></h3>
<div class="cell" data-execution_count="217">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x <span class="op">=</span> train[<span class="st">'maxEV'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>})</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'maxEV'</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Next Season HR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="217">
<pre><code>Text(0, 0.5, 'Next Season HR')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-38-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="hrperfb" class="level3">
<h3 class="anchored" data-anchor-id="hrperfb"><code>HRperFB</code></h3>
<div class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x <span class="op">=</span> train[<span class="st">'HRperFB'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>})</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'HR/FB'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Next Season HR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="218">
<pre><code>Text(0, 0.5, 'Next Season HR')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-39-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Seems like everything is basically linear, so transformations will probably not be necessary, at least with individual predictors.</p>
</section>
<section id="creating-a-visual-for-presentationreport" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-visual-for-presentationreport">Creating a Visual for Presentation/Report</h3>
<div class="cell" data-execution_count="306">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> train[<span class="st">'HR'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>}, ax <span class="op">=</span> axes[<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_xlabel(<span class="st">'Current Season HR'</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Next Season HR'</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> train[<span class="st">'Barrel'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>}, ax <span class="op">=</span> axes[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_xlabel(<span class="st">'Barrel%'</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Next Season HR'</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> train[<span class="st">'EV'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>}, ax <span class="op">=</span> axes[<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_xlabel(<span class="st">'Average Exit Velocity'</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Next Season HR'</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> train[<span class="st">'HardHit'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>}, ax <span class="op">=</span> axes[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_xlabel(<span class="st">'Hard Hit%'</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Next Season HR'</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> train[<span class="st">'maxEV'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>}, ax <span class="op">=</span> axes[<span class="dv">2</span>,<span class="dv">0</span>])</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>,<span class="dv">0</span>].set_xlabel(<span class="st">'Max Exit Velocity'</span>)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Next Season HR'</span>)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> train[<span class="st">'HRperFB'</span>], y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>], color <span class="op">=</span> <span class="st">'orange'</span>, line_kws <span class="op">=</span> {<span class="st">'color'</span>:<span class="st">'blue'</span>}, ax <span class="op">=</span> axes[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>,<span class="dv">1</span>].set_xlabel(<span class="st">'HR per Fly Ball'</span>)</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Next Season HR'</span>)</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="vs">r'.\Visualizations\correlation_plots.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="model-with-the-six-most-correlated-variables" class="level1">
<h1>Model with the Six Most Correlated Variables</h1>
<div class="cell" data-execution_count="300">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'Next_Year_HR~HR+Barrel+EV+HardHit+maxEV+HRperFB+I(HardHit**2)'</span>, data <span class="op">=</span> train).fit()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="300">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>      <td>Next_Year_HR</td>   <th>  R-squared:         </th> <td>   0.396</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.393</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   142.2</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 03 Mar 2023</td> <th>  Prob (F-statistic):</th> <td>2.95e-161</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:10:36</td>     <th>  Log-Likelihood:    </th> <td> -5384.7</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  1525</td>      <th>  AIC:               </th> <td>1.079e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  1517</td>      <th>  BIC:               </th> <td>1.083e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     7</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
         <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>       <td> -128.5473</td> <td>   20.994</td> <td>   -6.123</td> <td> 0.000</td> <td> -169.728</td> <td>  -87.367</td>
</tr>
<tr>
  <th>HR</th>              <td>    0.4451</td> <td>    0.032</td> <td>   14.108</td> <td> 0.000</td> <td>    0.383</td> <td>    0.507</td>
</tr>
<tr>
  <th>Barrel</th>          <td>    0.3925</td> <td>    0.112</td> <td>    3.510</td> <td> 0.000</td> <td>    0.173</td> <td>    0.612</td>
</tr>
<tr>
  <th>EV</th>              <td>    0.9160</td> <td>    0.248</td> <td>    3.690</td> <td> 0.000</td> <td>    0.429</td> <td>    1.403</td>
</tr>
<tr>
  <th>HardHit</th>         <td>    0.3219</td> <td>    0.169</td> <td>    1.901</td> <td> 0.057</td> <td>   -0.010</td> <td>    0.654</td>
</tr>
<tr>
  <th>maxEV</th>           <td>    0.4818</td> <td>    0.091</td> <td>    5.287</td> <td> 0.000</td> <td>    0.303</td> <td>    0.661</td>
</tr>
<tr>
  <th>HRperFB</th>         <td>   -0.2315</td> <td>    0.060</td> <td>   -3.834</td> <td> 0.000</td> <td>   -0.350</td> <td>   -0.113</td>
</tr>
<tr>
  <th>I(HardHit ** 2)</th> <td>   -0.0057</td> <td>    0.002</td> <td>   -2.408</td> <td> 0.016</td> <td>   -0.010</td> <td>   -0.001</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td>78.420</td> <th>  Durbin-Watson:     </th> <td>   1.926</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  93.461</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.532</td> <th>  Prob(JB):          </th> <td>5.07e-21</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.581</td> <th>  Cond. No.          </th> <td>1.52e+05</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The condition number is large, 1.52e+05. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
<section id="rse" class="level3">
<h3 class="anchored" data-anchor-id="rse">RSE</h3>
<div class="cell" data-execution_count="221">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(model.mse_resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="221">
<pre><code>8.28670207219361</code></pre>
</div>
</div>
</section>
<section id="rmse" class="level3">
<h3 class="anchored" data-anchor-id="rmse">RMSE</h3>
<div class="cell" data-execution_count="222">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(test)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mean_squared_error(test[<span class="st">'Next_Year_HR'</span>], pred, squared <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="222">
<pre><code>8.180564938161414</code></pre>
</div>
</div>
</section>
<section id="residual-plot" class="level2">
<h2 class="anchored" data-anchor-id="residual-plot">Residual Plot</h2>
<div class="cell" data-execution_count="305">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(font_scale<span class="op">=</span><span class="fl">1.25</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x <span class="op">=</span> model.fittedvalues, y<span class="op">=</span>model.resid,color <span class="op">=</span> <span class="st">'orange'</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x <span class="op">=</span> [model.fittedvalues.<span class="bu">min</span>(), model.fittedvalues.<span class="bu">max</span>()],y <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">0</span>],color <span class="op">=</span> <span class="st">'blue'</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Fitted values'</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="vs">r'.\Visualizations\first_model_res_plot.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-44-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="outlier-detection" class="level2">
<h2 class="anchored" data-anchor-id="outlier-detection">Outlier Detection</h2>
<section id="outliers" class="level3">
<h3 class="anchored" data-anchor-id="outliers">Outliers</h3>
<div class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> model.outlier_test()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x <span class="op">=</span> model.fittedvalues, y<span class="op">=</span>out.student_resid,color <span class="op">=</span> <span class="st">'orange'</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x <span class="op">=</span> [model.fittedvalues.<span class="bu">min</span>(),model.fittedvalues.<span class="bu">max</span>()],y <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">0</span>],color <span class="op">=</span> <span class="st">'blue'</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Fitted values'</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="225">
<pre><code>Text(0, 0.5, 'Residuals')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-46-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="226">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((np.<span class="bu">abs</span>(out.student_resid)<span class="op">&gt;</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="226">
<pre><code>8</code></pre>
</div>
</div>
</section>
<section id="high-leverage-points" class="level3">
<h3 class="anchored" data-anchor-id="high-leverage-points">High Leverage Points</h3>
<div class="cell" data-execution_count="227">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>influence <span class="op">=</span> model.get_influence()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>leverage <span class="op">=</span> influence.hat_matrix_diag</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>average_leverage <span class="op">=</span> (model.df_model<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>model.nobs</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>high_leverage_threshold <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>average_leverage</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(leverage<span class="op">&gt;</span>high_leverage_threshold)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="227">
<pre><code>27</code></pre>
</div>
</div>
</section>
<section id="influential-points" class="level3">
<h3 class="anchored" data-anchor-id="influential-points">Influential Points</h3>
<div class="cell" data-execution_count="228">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>train_filtered <span class="op">=</span> train.drop(np.intersect1d(np.where(np.<span class="bu">abs</span>(out.student_resid)<span class="op">&gt;</span><span class="dv">3</span>)[<span class="dv">0</span>],</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                                           (np.where(leverage<span class="op">&gt;</span>high_leverage_threshold)[<span class="dv">0</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="229">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>train.shape[<span class="dv">0</span>]<span class="op">-</span>train_filtered.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="229">
<pre><code>1</code></pre>
</div>
</div>
</section>
</section>
<section id="updated-model" class="level2">
<h2 class="anchored" data-anchor-id="updated-model">Updated Model</h2>
<div class="cell" data-execution_count="307">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'Next_Year_HR~HR+Barrel+EV+HardHit+maxEV+HRperFB+I(HardHit**2)'</span>, data <span class="op">=</span> train_filtered).fit()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="307">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>      <td>Next_Year_HR</td>   <th>  R-squared:         </th> <td>   0.396</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.393</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   142.2</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 03 Mar 2023</td> <th>  Prob (F-statistic):</th> <td>2.95e-161</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:11:47</td>     <th>  Log-Likelihood:    </th> <td> -5384.7</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  1525</td>      <th>  AIC:               </th> <td>1.079e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  1517</td>      <th>  BIC:               </th> <td>1.083e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     7</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
         <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>       <td> -128.5473</td> <td>   20.994</td> <td>   -6.123</td> <td> 0.000</td> <td> -169.728</td> <td>  -87.367</td>
</tr>
<tr>
  <th>HR</th>              <td>    0.4451</td> <td>    0.032</td> <td>   14.108</td> <td> 0.000</td> <td>    0.383</td> <td>    0.507</td>
</tr>
<tr>
  <th>Barrel</th>          <td>    0.3925</td> <td>    0.112</td> <td>    3.510</td> <td> 0.000</td> <td>    0.173</td> <td>    0.612</td>
</tr>
<tr>
  <th>EV</th>              <td>    0.9160</td> <td>    0.248</td> <td>    3.690</td> <td> 0.000</td> <td>    0.429</td> <td>    1.403</td>
</tr>
<tr>
  <th>HardHit</th>         <td>    0.3219</td> <td>    0.169</td> <td>    1.901</td> <td> 0.057</td> <td>   -0.010</td> <td>    0.654</td>
</tr>
<tr>
  <th>maxEV</th>           <td>    0.4818</td> <td>    0.091</td> <td>    5.287</td> <td> 0.000</td> <td>    0.303</td> <td>    0.661</td>
</tr>
<tr>
  <th>HRperFB</th>         <td>   -0.2315</td> <td>    0.060</td> <td>   -3.834</td> <td> 0.000</td> <td>   -0.350</td> <td>   -0.113</td>
</tr>
<tr>
  <th>I(HardHit ** 2)</th> <td>   -0.0057</td> <td>    0.002</td> <td>   -2.408</td> <td> 0.016</td> <td>   -0.010</td> <td>   -0.001</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td>78.420</td> <th>  Durbin-Watson:     </th> <td>   1.926</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  93.461</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.532</td> <th>  Prob(JB):          </th> <td>5.07e-21</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.581</td> <th>  Cond. No.          </th> <td>1.52e+05</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The condition number is large, 1.52e+05. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
<section id="rse-1" class="level3">
<h3 class="anchored" data-anchor-id="rse-1">RSE</h3>
<div class="cell" data-execution_count="231">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(model.mse_resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="231">
<pre><code>8.257467196473222</code></pre>
</div>
</div>
</section>
<section id="rmse-1" class="level3">
<h3 class="anchored" data-anchor-id="rmse-1">RMSE</h3>
<div class="cell" data-execution_count="232">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(test)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>mean_squared_error(test[<span class="st">'Next_Year_HR'</span>], pred, squared <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="232">
<pre><code>8.168925903929695</code></pre>
</div>
</div>
</section>
</section>
<section id="observations" class="level2">
<h2 class="anchored" data-anchor-id="observations">Observations</h2>
<ul>
<li>No overfitting, test RMSE and train RSE line up well</li>
<li>Linearity assumption seems to be okay</li>
<li>Constant variance of error terms assumption is definitely violated
<ul>
<li>Model seems to have a much easier time predicting following season totals for players who don’t hit very many home runs in the current year</li>
<li>This makes sense to an extent as at the top end, HR totals are very volatile, a guy can hit 60 one year and 35 the next, whereas a guy who hits 5 one season isn’t suddenly going to hit 25, and injuries also play a small role</li>
</ul></li>
<li>One influential point, which after being dropped, the model was more accurate</li>
</ul>
</section>
</section>
<section id="engineering-a-new-model" class="level1">
<h1>Engineering a New Model</h1>
<div class="cell" data-execution_count="309">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'np.sqrt(Next_Year_HR)~HR+Barrel+(EV*maxEV)+HardHit+I(HardHit**2)+(HRperFB*FB)+(IFFB*FB)+Pull+PA+BB+K+GB'</span>, data <span class="op">=</span> train).fit()</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="309">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>    <td>np.sqrt(Next_Year_HR)</td> <th>  R-squared:         </th> <td>   0.438</td> 
</tr>
<tr>
  <th>Model:</th>                     <td>OLS</td>          <th>  Adj. R-squared:    </th> <td>   0.431</td> 
</tr>
<tr>
  <th>Method:</th>               <td>Least Squares</td>     <th>  F-statistic:       </th> <td>   69.00</td> 
</tr>
<tr>
  <th>Date:</th>               <td>Fri, 03 Mar 2023</td>    <th>  Prob (F-statistic):</th> <td>2.39e-174</td>
</tr>
<tr>
  <th>Time:</th>                   <td>13:12:00</td>        <th>  Log-Likelihood:    </th> <td> -2204.8</td> 
</tr>
<tr>
  <th>No. Observations:</th>        <td>  1525</td>         <th>  AIC:               </th> <td>   4446.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>            <td>  1507</td>         <th>  BIC:               </th> <td>   4541.</td> 
</tr>
<tr>
  <th>Df Model:</th>                <td>    17</td>         <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>        <td>nonrobust</td>       <th>                     </th>     <td> </td>    
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
         <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>       <td>   85.9873</td> <td>   41.741</td> <td>    2.060</td> <td> 0.040</td> <td>    4.111</td> <td>  167.864</td>
</tr>
<tr>
  <th>HR</th>              <td>    0.0171</td> <td>    0.009</td> <td>    1.883</td> <td> 0.060</td> <td>   -0.001</td> <td>    0.035</td>
</tr>
<tr>
  <th>Barrel</th>          <td>    0.0208</td> <td>    0.018</td> <td>    1.140</td> <td> 0.254</td> <td>   -0.015</td> <td>    0.056</td>
</tr>
<tr>
  <th>EV</th>              <td>   -1.0637</td> <td>    0.474</td> <td>   -2.243</td> <td> 0.025</td> <td>   -1.994</td> <td>   -0.134</td>
</tr>
<tr>
  <th>maxEV</th>           <td>   -0.8581</td> <td>    0.379</td> <td>   -2.263</td> <td> 0.024</td> <td>   -1.602</td> <td>   -0.114</td>
</tr>
<tr>
  <th>EV:maxEV</th>        <td>    0.0104</td> <td>    0.004</td> <td>    2.442</td> <td> 0.015</td> <td>    0.002</td> <td>    0.019</td>
</tr>
<tr>
  <th>HardHit</th>         <td>    0.1310</td> <td>    0.031</td> <td>    4.293</td> <td> 0.000</td> <td>    0.071</td> <td>    0.191</td>
</tr>
<tr>
  <th>I(HardHit ** 2)</th> <td>   -0.0016</td> <td>    0.000</td> <td>   -3.965</td> <td> 0.000</td> <td>   -0.002</td> <td>   -0.001</td>
</tr>
<tr>
  <th>HRperFB</th>         <td>    0.0599</td> <td>    0.021</td> <td>    2.921</td> <td> 0.004</td> <td>    0.020</td> <td>    0.100</td>
</tr>
<tr>
  <th>FB</th>              <td>    0.0406</td> <td>    0.015</td> <td>    2.740</td> <td> 0.006</td> <td>    0.012</td> <td>    0.070</td>
</tr>
<tr>
  <th>HRperFB:FB</th>      <td>   -0.0015</td> <td>    0.001</td> <td>   -2.444</td> <td> 0.015</td> <td>   -0.003</td> <td>   -0.000</td>
</tr>
<tr>
  <th>IFFB</th>            <td>    0.0343</td> <td>    0.028</td> <td>    1.234</td> <td> 0.218</td> <td>   -0.020</td> <td>    0.089</td>
</tr>
<tr>
  <th>IFFB:FB</th>         <td>   -0.0007</td> <td>    0.001</td> <td>   -0.860</td> <td> 0.390</td> <td>   -0.002</td> <td>    0.001</td>
</tr>
<tr>
  <th>Pull</th>            <td>    0.0163</td> <td>    0.006</td> <td>    2.849</td> <td> 0.004</td> <td>    0.005</td> <td>    0.028</td>
</tr>
<tr>
  <th>PA</th>              <td>    0.0014</td> <td>    0.000</td> <td>    3.730</td> <td> 0.000</td> <td>    0.001</td> <td>    0.002</td>
</tr>
<tr>
  <th>BB</th>              <td>   -0.0098</td> <td>    0.009</td> <td>   -1.087</td> <td> 0.277</td> <td>   -0.027</td> <td>    0.008</td>
</tr>
<tr>
  <th>K</th>               <td>   -0.0091</td> <td>    0.006</td> <td>   -1.452</td> <td> 0.147</td> <td>   -0.021</td> <td>    0.003</td>
</tr>
<tr>
  <th>GB</th>              <td>   -0.0151</td> <td>    0.009</td> <td>   -1.690</td> <td> 0.091</td> <td>   -0.033</td> <td>    0.002</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td> 7.915</td> <th>  Durbin-Watson:     </th> <td>   1.857</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.019</td> <th>  Jarque-Bera (JB):  </th> <td>   7.880</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.174</td> <th>  Prob(JB):          </th> <td>  0.0195</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.048</td> <th>  Cond. No.          </th> <td>1.57e+07</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The condition number is large, 1.57e+07. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
<section id="rse-2" class="level3">
<h3 class="anchored" data-anchor-id="rse-2">RSE</h3>
<div class="cell" data-execution_count="267">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(((train[<span class="st">'Next_Year_HR'</span>] <span class="op">-</span> (model.fittedvalues<span class="op">**</span><span class="dv">2</span>))<span class="op">**</span><span class="dv">2</span>).mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="267">
<pre><code>8.18580192251846</code></pre>
</div>
</div>
</section>
<section id="rmse-2" class="level3">
<h3 class="anchored" data-anchor-id="rmse-2">RMSE</h3>
<div class="cell" data-execution_count="268">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(test)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>np.sqrt(((test[<span class="st">'Next_Year_HR'</span>] <span class="op">-</span> (pred<span class="op">**</span><span class="dv">2</span>))<span class="op">**</span><span class="dv">2</span>).mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="268">
<pre><code>8.043329798002166</code></pre>
</div>
</div>
</section>
<section id="residual-plot-1" class="level2">
<h2 class="anchored" data-anchor-id="residual-plot-1">Residual Plot</h2>
<div class="cell" data-execution_count="310">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(font_scale<span class="op">=</span><span class="fl">1.25</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x <span class="op">=</span> model.fittedvalues, y<span class="op">=</span>model.resid,color <span class="op">=</span> <span class="st">'orange'</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x <span class="op">=</span> [model.fittedvalues.<span class="bu">min</span>(), model.fittedvalues.<span class="bu">max</span>()],y <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">0</span>],color <span class="op">=</span> <span class="st">'blue'</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Fitted values'</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="vs">r'.\Visualizations\engineered_model_res_plot.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-57-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="outlier-detection-1" class="level2">
<h2 class="anchored" data-anchor-id="outlier-detection-1">Outlier Detection</h2>
<section id="outliers-1" class="level3">
<h3 class="anchored" data-anchor-id="outliers-1">Outliers</h3>
<div class="cell" data-execution_count="270">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> model.outlier_test()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="271">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x <span class="op">=</span> model.fittedvalues, y<span class="op">=</span>out.student_resid,color <span class="op">=</span> <span class="st">'orange'</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x <span class="op">=</span> [model.fittedvalues.<span class="bu">min</span>(),model.fittedvalues.<span class="bu">max</span>()],y <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">0</span>],color <span class="op">=</span> <span class="st">'blue'</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Fitted values'</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="271">
<pre><code>Text(0, 0.5, 'Residuals')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-59-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="272">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((np.<span class="bu">abs</span>(out.student_resid)<span class="op">&gt;</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="272">
<pre><code>5</code></pre>
</div>
</div>
</section>
<section id="high-leverage-points-1" class="level3">
<h3 class="anchored" data-anchor-id="high-leverage-points-1">High Leverage Points</h3>
<div class="cell" data-execution_count="273">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>influence <span class="op">=</span> model.get_influence()</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>leverage <span class="op">=</span> influence.hat_matrix_diag</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>average_leverage <span class="op">=</span> (model.df_model<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>model.nobs</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>high_leverage_threshold <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>average_leverage</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(leverage<span class="op">&gt;</span>high_leverage_threshold)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="273">
<pre><code>24</code></pre>
</div>
</div>
</section>
<section id="influential-points-1" class="level3">
<h3 class="anchored" data-anchor-id="influential-points-1">Influential Points</h3>
<div class="cell" data-execution_count="274">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>train_filtered <span class="op">=</span> train.drop(np.intersect1d(np.where(np.<span class="bu">abs</span>(out.student_resid)<span class="op">&gt;</span><span class="dv">3</span>)[<span class="dv">0</span>],</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                                           (np.where(leverage<span class="op">&gt;</span>high_leverage_threshold)[<span class="dv">0</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="275">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>train.shape[<span class="dv">0</span>]<span class="op">-</span>train_filtered.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="275">
<pre><code>0</code></pre>
</div>
</div>
</section>
</section>
<section id="observations-1" class="level2">
<h2 class="anchored" data-anchor-id="observations-1">Observations</h2>
<ul>
<li>Few predictors with high p-values now</li>
<li>Able to get train RSE and test RMSE to go down though</li>
<li>Linearity assumption and constant variance of error terms assumption both look much better with taking the square root of the response</li>
<li>Still no influential points, which is also good</li>
<li><strong>Think this is basically the best possible, and if it isn’t, it’s close</strong></li>
</ul>
</section>
</section>
<section id="trying-lasso-because-why-not" class="level1">
<h1>Trying Lasso Because Why Not</h1>
<div class="cell" data-execution_count="294">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> train[<span class="st">'Next_Year_HR'</span>]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> train.iloc[:,[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>]]</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>scaler.fit(X)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>Xstd <span class="op">=</span> scaler.transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="295">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>np.linspace(<span class="dv">10</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">100</span>)<span class="op">*</span><span class="fl">0.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="296">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(max_iter <span class="op">=</span> <span class="dv">10000</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>coefs <span class="op">=</span> []</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> a <span class="kw">in</span> alphas:</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    lasso.set_params(alpha<span class="op">=</span>a)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    lasso.fit(Xstd, y)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    coefs.append(lasso.coef_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="297">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'xlabel'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'ylabel'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>plt.plot(alphas, coefs)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Standardized coefficient'</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>plt.legend(train.columns[[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>]])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-67-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="298">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>np.linspace(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">200</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>lassocv <span class="op">=</span> LassoCV(alphas <span class="op">=</span> alphas, cv <span class="op">=</span> <span class="dv">10</span>, max_iter <span class="op">=</span> <span class="dv">100000</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>lassocv.fit(Xstd, y)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>lassocv.alpha_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="298">
<pre><code>0.05</code></pre>
</div>
</div>
<div class="cell" data-execution_count="311">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>np.linspace(<span class="dv">10</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">100</span>)<span class="op">*</span><span class="fl">0.1</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'xlabel'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'ylabel'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>plt.plot(alphas, coefs)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$\lambda$'</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Standardized coefficient'</span>)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>plt.legend(train.columns[[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>]])<span class="op">;</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>plt.plot([lassocv.alpha_,lassocv.alpha_],[<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>],<span class="st">':'</span>)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="vs">r'.\Visualizations\lasso_plot.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Working%20Document_files/figure-html/cell-69-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="rse-3" class="level3">
<h3 class="anchored" data-anchor-id="rse-3">RSE</h3>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> lassocv.alpha_)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>lasso.fit(Xstd, y)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>pred<span class="op">=</span>lasso.predict(Xstd)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>np.sqrt(((pred<span class="op">-</span>train[<span class="st">'Next_Year_HR'</span>])<span class="op">**</span><span class="dv">2</span>).mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>8.141505675471118</code></pre>
</div>
</div>
</section>
<section id="rmse-3" class="level3">
<h3 class="anchored" data-anchor-id="rmse-3">RMSE</h3>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>Xtest <span class="op">=</span> test.iloc[:,[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>]]</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>Xtest_std <span class="op">=</span> scaler.transform(Xtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha <span class="op">=</span> lassocv.alpha_)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>lasso.fit(Xstd, y)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>pred<span class="op">=</span>lasso.predict(Xtest_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(((pred<span class="op">-</span>test[<span class="st">'Next_Year_HR'</span>])<span class="op">**</span><span class="dv">2</span>).mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>8.136334981853635</code></pre>
</div>
</div>
</section>
<section id="coefficients-and-r2" class="level3">
<h3 class="anchored" data-anchor-id="coefficients-and-r2">Coefficients and <span class="math inline">\(R^2\)</span></h3>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>lasso.coef_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>array([-1.68038103,  2.56960505,  2.51588206, -0.        , -0.06249362,
        0.        , -0.32402915,  0.3373001 ,  0.21207321, -0.        ,
        0.62269778, -0.        , -0.01402876,  1.76347944,  1.86058027,
        0.64702814,  0.27226912,  0.        ])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>r2_score(lasso.predict(Xstd),y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>-0.45469770476085425</code></pre>
</div>
</div>
</section>
<section id="formula" class="level2">
<h2 class="anchored" data-anchor-id="formula">Formula</h2>
<p><span class="math inline">\(\text{Next_Year_HR} = -1.68 \cdot \text{G} + 2.57 \cdot \text{PA} + 2.52 \cdot \text{HR} -0.06 \cdot \text{K_pct} - 0.32 \cdot \text{GB_pct} + 0.34 \cdot \text{FB_pct} + 0.21 \cdot \text{IFFB_pct} + 0.62 \cdot \text{Pull_pct} - 0.01 \cdot \text{Oppo_pct} + 1.76 \cdot \text{Avg_EV} + 1.86 \cdot \text{max_EV} + 0.65 \cdot \text{Avg_LA} + 0.27 \cdot \text{Barrel_pct}\)</span></p>
</section>
</section>
<section id="making-predictions-for-the-2023-season" class="level1">
<h1>Making Predictions for the 2023 Season</h1>
<div class="cell" data-execution_count="247">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>dashboard_2022_merge <span class="op">=</span> dashboard_2022.loc[:, [<span class="st">'Name'</span>, <span class="st">'G'</span>, <span class="st">'PA'</span>, <span class="st">'HR'</span>, <span class="st">'BB%'</span>, <span class="st">'K%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>batted_ball_2022_merge <span class="op">=</span> batted_ball_2022.loc[:, [<span class="st">'LD%'</span>, <span class="st">'GB%'</span>, <span class="st">'FB%'</span>, <span class="st">'IFFB%'</span>, <span class="st">'HR/FB'</span>, <span class="st">'Pull%'</span>, <span class="st">'Cent%'</span>, <span class="st">'Oppo%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>statcast_2022_merge <span class="op">=</span> statcast_2022.loc[:, [<span class="st">'EV'</span>, <span class="st">'maxEV'</span>, <span class="st">'LA'</span>, <span class="st">'Barrel%'</span>, <span class="st">'HardHit%'</span>, <span class="st">'playerid'</span>]]</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>temp_frame_2022 <span class="op">=</span> pd.merge(dashboard_2022_merge, batted_ball_2022_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>temp_frame_2022_2 <span class="op">=</span> pd.merge(temp_frame_2022, statcast_2022_merge, on <span class="op">=</span> <span class="st">'playerid'</span>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>temp_frame_2022_2[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">2022</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>player_data_2022 <span class="op">=</span> temp_frame_2022_2</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>player_data_2022 <span class="op">=</span> player_data_2022.rename(columns <span class="op">=</span> {<span class="st">'Barrel%'</span>: <span class="st">'Barrel'</span>, <span class="st">'HardHit%'</span>: <span class="st">'HardHit'</span>, <span class="st">'HR/FB'</span>: <span class="st">'HRperFB'</span>, <span class="st">'BB%'</span>:<span class="st">'BB'</span>, <span class="st">'K%'</span>:<span class="st">'K'</span>, <span class="st">'FB%'</span>:<span class="st">'FB'</span>, <span class="st">'Pull%'</span>:<span class="st">'Pull'</span>, <span class="st">'GB%'</span>:<span class="st">'GB'</span>, <span class="st">'LD%'</span>:<span class="st">'LD'</span>,<span class="st">'IFFB%'</span>:<span class="st">'IFFB'</span>, <span class="st">'Cent%'</span>:<span class="st">'Cent'</span>, <span class="st">'Oppo%'</span>:<span class="st">'Oppo'</span>})</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[:, <span class="st">'G'</span>:] <span class="op">=</span> player_data_2022.loc[:, <span class="st">'G'</span>:].<span class="bu">apply</span>(remove_percentage_sign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="lasso-formula" class="level3">
<h3 class="anchored" data-anchor-id="lasso-formula">Lasso Formula</h3>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>Xpredict <span class="op">=</span> player_data_2022.iloc[:,[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>]]</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>Xpredict_std <span class="op">=</span> scaler.transform(Xpredict)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>predictions<span class="op">=</span>lasso.predict(Xpredict_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mlr-formula" class="level3">
<h3 class="anchored" data-anchor-id="mlr-formula">MLR Formula</h3>
<div class="cell" data-execution_count="276">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predict(player_data_2022)<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="277">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>player_data_2022[<span class="st">'Predicted_HR_2023'</span>] <span class="op">=</span> predictions</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>player_data_2022[<span class="st">'Predicted_HR_2023_Integers'</span>] <span class="op">=</span> player_data_2022[<span class="st">'Predicted_HR_2023'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>player_data_2022 <span class="op">=</span> player_data_2022.sort_values(by <span class="op">=</span> <span class="st">'Predicted_HR_2023'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="278">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[:, [<span class="st">'Name'</span>, <span class="st">'Predicted_HR_2023_Integers'</span>]].head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="278">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Predicted_HR_2023_Integers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aaron Judge</td>
      <td>42</td>
    </tr>
    <tr>
      <th>194</th>
      <td>Giancarlo Stanton</td>
      <td>33</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Shohei Ohtani</td>
      <td>33</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Kyle Schwarber</td>
      <td>32</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Matt Olson</td>
      <td>32</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Austin Riley</td>
      <td>31</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Vladimir Guerrero Jr.</td>
      <td>31</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Yordan Alvarez</td>
      <td>31</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Pete Alonso</td>
      <td>30</td>
    </tr>
    <tr>
      <th>220</th>
      <td>Rowdy Tellez</td>
      <td>29</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Mike Trout</td>
      <td>28</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Oneil Cruz</td>
      <td>28</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Anthony Santander</td>
      <td>27</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Byron Buxton</td>
      <td>26</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Julio Rodriguez</td>
      <td>26</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Matt Chapman</td>
      <td>26</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Jose Ramirez</td>
      <td>26</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Cal Raleigh</td>
      <td>26</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Christian Walker</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Nolan Arenado</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="279">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[:, [<span class="st">'Name'</span>, <span class="st">'Predicted_HR_2023_Integers'</span>]].tail(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="279">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Predicted_HR_2023_Integers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>195</th>
      <td>Omar Narvaez</td>
      <td>5</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Tomas Nido</td>
      <td>5</td>
    </tr>
    <tr>
      <th>163</th>
      <td>Tony Kemp</td>
      <td>5</td>
    </tr>
    <tr>
      <th>304</th>
      <td>Alfonso Rivas</td>
      <td>5</td>
    </tr>
    <tr>
      <th>260</th>
      <td>Albert Almora Jr.</td>
      <td>5</td>
    </tr>
    <tr>
      <th>354</th>
      <td>Jonathan Villar</td>
      <td>5</td>
    </tr>
    <tr>
      <th>257</th>
      <td>Matt Reynolds</td>
      <td>5</td>
    </tr>
    <tr>
      <th>327</th>
      <td>Sheldon Neuse</td>
      <td>5</td>
    </tr>
    <tr>
      <th>277</th>
      <td>P.J. Higgins</td>
      <td>5</td>
    </tr>
    <tr>
      <th>324</th>
      <td>Garrett Hampson</td>
      <td>5</td>
    </tr>
    <tr>
      <th>296</th>
      <td>Gilberto Celestino</td>
      <td>4</td>
    </tr>
    <tr>
      <th>302</th>
      <td>Matt Duffy</td>
      <td>4</td>
    </tr>
    <tr>
      <th>312</th>
      <td>Tucker Barnhart</td>
      <td>4</td>
    </tr>
    <tr>
      <th>243</th>
      <td>Nick Allen</td>
      <td>4</td>
    </tr>
    <tr>
      <th>239</th>
      <td>Jose Azocar</td>
      <td>4</td>
    </tr>
    <tr>
      <th>187</th>
      <td>Nicky Lopez</td>
      <td>3</td>
    </tr>
    <tr>
      <th>225</th>
      <td>Yonathan Daza</td>
      <td>3</td>
    </tr>
    <tr>
      <th>175</th>
      <td>Luis Guillorme</td>
      <td>3</td>
    </tr>
    <tr>
      <th>274</th>
      <td>Nick Madrigal</td>
      <td>1</td>
    </tr>
    <tr>
      <th>227</th>
      <td>David Fletcher</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="280">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[player_data_2022[<span class="st">'Name'</span>] <span class="op">==</span> <span class="st">'Luis Robert'</span>, [<span class="st">'Name'</span>, <span class="st">'Predicted_HR_2023_Integers'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="280">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Predicted_HR_2023_Integers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>116</th>
      <td>Luis Robert</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="281">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>player_data_2022[<span class="st">'Difference_in_HR'</span>] <span class="op">=</span> player_data_2022[<span class="st">'Predicted_HR_2023_Integers'</span>] <span class="op">-</span> player_data_2022[<span class="st">'HR'</span>]</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>player_data_2022 <span class="op">=</span> player_data_2022.sort_values(by <span class="op">=</span> <span class="st">'Difference_in_HR'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="282">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[:, [<span class="st">'Name'</span>, <span class="st">'Difference_in_HR'</span>, <span class="st">'Predicted_HR_2023_Integers'</span>]].head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="282">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Difference_in_HR</th>
      <th>Predicted_HR_2023_Integers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>328</th>
      <td>Sam Hilliard</td>
      <td>12</td>
      <td>14</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Oneil Cruz</td>
      <td>11</td>
      <td>28</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Seby Zavala</td>
      <td>9</td>
      <td>11</td>
    </tr>
    <tr>
      <th>316</th>
      <td>J.J. Bleday</td>
      <td>9</td>
      <td>14</td>
    </tr>
    <tr>
      <th>240</th>
      <td>Jorge Soler</td>
      <td>9</td>
      <td>22</td>
    </tr>
    <tr>
      <th>244</th>
      <td>Enrique Hernandez</td>
      <td>9</td>
      <td>15</td>
    </tr>
    <tr>
      <th>310</th>
      <td>Franchy Cordero</td>
      <td>9</td>
      <td>17</td>
    </tr>
    <tr>
      <th>224</th>
      <td>Kyle Isbel</td>
      <td>8</td>
      <td>13</td>
    </tr>
    <tr>
      <th>214</th>
      <td>Ryan Jeffers</td>
      <td>8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Leody Taveras</td>
      <td>8</td>
      <td>13</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Dylan Moore</td>
      <td>8</td>
      <td>14</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Ketel Marte</td>
      <td>8</td>
      <td>20</td>
    </tr>
    <tr>
      <th>283</th>
      <td>Paul DeJong</td>
      <td>8</td>
      <td>14</td>
    </tr>
    <tr>
      <th>347</th>
      <td>Spencer Torkelson</td>
      <td>8</td>
      <td>16</td>
    </tr>
    <tr>
      <th>306</th>
      <td>Adam Engel</td>
      <td>8</td>
      <td>10</td>
    </tr>
    <tr>
      <th>275</th>
      <td>Austin Nola</td>
      <td>8</td>
      <td>12</td>
    </tr>
    <tr>
      <th>140</th>
      <td>David Peralta</td>
      <td>7</td>
      <td>19</td>
    </tr>
    <tr>
      <th>325</th>
      <td>Mike Moustakas</td>
      <td>7</td>
      <td>14</td>
    </tr>
    <tr>
      <th>123</th>
      <td>Max Kepler</td>
      <td>7</td>
      <td>16</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Yandy Diaz</td>
      <td>7</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="283">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[:, [<span class="st">'Name'</span>, <span class="st">'Difference_in_HR'</span>, <span class="st">'Predicted_HR_2023_Integers'</span>]].tail(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="283">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Difference_in_HR</th>
      <th>Predicted_HR_2023_Integers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>86</th>
      <td>Anthony Santander</td>
      <td>-6</td>
      <td>27</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Bryan Reynolds</td>
      <td>-6</td>
      <td>21</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Hunter Renfroe</td>
      <td>-6</td>
      <td>23</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Nathaniel Lowe</td>
      <td>-7</td>
      <td>20</td>
    </tr>
    <tr>
      <th>183</th>
      <td>C.J. Cron</td>
      <td>-7</td>
      <td>22</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Austin Riley</td>
      <td>-7</td>
      <td>31</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Daulton Varsho</td>
      <td>-7</td>
      <td>20</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Anthony Rizzo</td>
      <td>-7</td>
      <td>25</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Eugenio Suarez</td>
      <td>-8</td>
      <td>23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Manny Machado</td>
      <td>-8</td>
      <td>24</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Willy Adames</td>
      <td>-9</td>
      <td>22</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Corey Seager</td>
      <td>-10</td>
      <td>23</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Pete Alonso</td>
      <td>-10</td>
      <td>30</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Christian Walker</td>
      <td>-11</td>
      <td>25</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jose Altuve</td>
      <td>-11</td>
      <td>17</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mookie Betts</td>
      <td>-11</td>
      <td>24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Paul Goldschmidt</td>
      <td>-12</td>
      <td>23</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Mike Trout</td>
      <td>-12</td>
      <td>28</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Kyle Schwarber</td>
      <td>-14</td>
      <td>32</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Aaron Judge</td>
      <td>-20</td>
      <td>42</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="284">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>player_data_2022[<span class="st">'Pct_Difference_in_HR'</span>] <span class="op">=</span> <span class="dv">100</span><span class="op">*</span>(player_data_2022[<span class="st">'Predicted_HR_2023_Integers'</span>] <span class="op">-</span> player_data_2022[<span class="st">'HR'</span>])<span class="op">/</span>player_data_2022[<span class="st">'HR'</span>]</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>player_data_2022 <span class="op">=</span> player_data_2022.sort_values(by <span class="op">=</span> <span class="st">'Pct_Difference_in_HR'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="285">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[:, [<span class="st">'Name'</span>, <span class="st">'Pct_Difference_in_HR'</span>, <span class="st">'Predicted_HR_2023_Integers'</span>]].head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="285">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Pct_Difference_in_HR</th>
      <th>Predicted_HR_2023_Integers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>239</th>
      <td>Jose Azocar</td>
      <td>inf</td>
      <td>4</td>
    </tr>
    <tr>
      <th>187</th>
      <td>Nicky Lopez</td>
      <td>inf</td>
      <td>3</td>
    </tr>
    <tr>
      <th>126</th>
      <td>Myles Straw</td>
      <td>inf</td>
      <td>6</td>
    </tr>
    <tr>
      <th>274</th>
      <td>Nick Madrigal</td>
      <td>inf</td>
      <td>1</td>
    </tr>
    <tr>
      <th>305</th>
      <td>Vimael Machin</td>
      <td>700.000000</td>
      <td>8</td>
    </tr>
    <tr>
      <th>252</th>
      <td>Cesar Hernandez</td>
      <td>700.000000</td>
      <td>8</td>
    </tr>
    <tr>
      <th>328</th>
      <td>Sam Hilliard</td>
      <td>600.000000</td>
      <td>14</td>
    </tr>
    <tr>
      <th>313</th>
      <td>Didi Gregorius</td>
      <td>500.000000</td>
      <td>6</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Seby Zavala</td>
      <td>450.000000</td>
      <td>11</td>
    </tr>
    <tr>
      <th>306</th>
      <td>Adam Engel</td>
      <td>400.000000</td>
      <td>10</td>
    </tr>
    <tr>
      <th>312</th>
      <td>Tucker Barnhart</td>
      <td>300.000000</td>
      <td>4</td>
    </tr>
    <tr>
      <th>288</th>
      <td>Josh Smith</td>
      <td>300.000000</td>
      <td>8</td>
    </tr>
    <tr>
      <th>314</th>
      <td>CJ Abrams</td>
      <td>250.000000</td>
      <td>7</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Kevin Newman</td>
      <td>250.000000</td>
      <td>7</td>
    </tr>
    <tr>
      <th>311</th>
      <td>Victor Reyes</td>
      <td>233.333333</td>
      <td>10</td>
    </tr>
    <tr>
      <th>308</th>
      <td>Akil Baddoo</td>
      <td>200.000000</td>
      <td>6</td>
    </tr>
    <tr>
      <th>319</th>
      <td>Jarren Duran</td>
      <td>200.000000</td>
      <td>9</td>
    </tr>
    <tr>
      <th>275</th>
      <td>Austin Nola</td>
      <td>200.000000</td>
      <td>12</td>
    </tr>
    <tr>
      <th>145</th>
      <td>Reese McGuire</td>
      <td>200.000000</td>
      <td>9</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Cooper Hummel</td>
      <td>200.000000</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="286">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>player_data_2022.loc[:, [<span class="st">'Name'</span>, <span class="st">'Pct_Difference_in_HR'</span>, <span class="st">'Predicted_HR_2023_Integers'</span>]].tail(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="286">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Pct_Difference_in_HR</th>
      <th>Predicted_HR_2023_Integers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>146</th>
      <td>Luis Rengifo</td>
      <td>-23.529412</td>
      <td>13</td>
    </tr>
    <tr>
      <th>183</th>
      <td>C.J. Cron</td>
      <td>-24.137931</td>
      <td>22</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Pete Alonso</td>
      <td>-25.000000</td>
      <td>30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Manny Machado</td>
      <td>-25.000000</td>
      <td>24</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Ty France</td>
      <td>-25.000000</td>
      <td>15</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Eugenio Suarez</td>
      <td>-25.806452</td>
      <td>23</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Nathaniel Lowe</td>
      <td>-25.925926</td>
      <td>20</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Daulton Varsho</td>
      <td>-25.925926</td>
      <td>20</td>
    </tr>
    <tr>
      <th>163</th>
      <td>Tony Kemp</td>
      <td>-28.571429</td>
      <td>5</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Willy Adames</td>
      <td>-29.032258</td>
      <td>22</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Mike Trout</td>
      <td>-30.000000</td>
      <td>28</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Corey Seager</td>
      <td>-30.303030</td>
      <td>23</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Kyle Schwarber</td>
      <td>-30.434783</td>
      <td>32</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Christian Walker</td>
      <td>-30.555556</td>
      <td>25</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mookie Betts</td>
      <td>-31.428571</td>
      <td>24</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Aaron Judge</td>
      <td>-32.258065</td>
      <td>42</td>
    </tr>
    <tr>
      <th>205</th>
      <td>Jake Fraley</td>
      <td>-33.333333</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Paul Goldschmidt</td>
      <td>-34.285714</td>
      <td>23</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jose Altuve</td>
      <td>-39.285714</td>
      <td>17</td>
    </tr>
    <tr>
      <th>227</th>
      <td>David Fletcher</td>
      <td>-50.000000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>